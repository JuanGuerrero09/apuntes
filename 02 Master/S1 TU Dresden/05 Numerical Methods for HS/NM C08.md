---
Class: "[[05 Numerical Methods for HS]]"
Date: 2025-12-10
Last Modified: Wednesday 10th December 2025 09:20
---

# üìÖ Wednesday 10th December 2025

# üìí Class Summary

The lecture focused on advanced numerical strategies for complex fluid flows. Key topics included **Grid Convergence Studies (GCS)** to validate numerical accuracy, a comprehensive review of **Turbulence Modeling** (from RANS to LES), and the shift from Finite Differences to **Finite Volume Methods (FVM)** using **Staggered Grids** to ensure stability and conservation at high Reynolds numbers.

---

# üìù Notes

## 1. Grid Convergence Study (GCS)

To ensure that a numerical solution is independent of the mesh size, a GCS is performed. In Exercise 3, we analyze the **scalar flux** $\psi$ at the top boundary:

$$\psi = -D\int_0^L\frac{\partial \phi(x,L,t_{end})}{\partial y}dx$$

Evaluating the order of convergence helps verify if the spatial discretization (e.g., Central Differences) is behaving with the expected theoretical accuracy (e.g., $O(\Delta x^2)$).

## 2. Turbulence Modeling

Turbulence consists of a hierarchy of **eddies** (vortical structures) across different scales.

### The Energy Cascade

- **Large Eddies:** Generated by the mean flow (scale with flow depth). They carry the bulk of the kinetic energy.
    
- **Kolmogorov Microscale ($\eta$):** The smallest scales where viscous forces dominate and dissipate kinetic energy into heat.
    

### Reynolds-Averaged Navier-Stokes (RANS)

RANS models solve for the time-averaged flow. The averaging process introduces the **Closure Problem**: a new unknown term called **Reynolds Stress** ($\overline{u_i'u_j'}$).

- Turbulent Viscosity Hypothesis: To close the equations, we assume Reynolds stresses act like a "turbulent viscosity" ($\mu_t$):
    
    $$-\rho\overline{u_i'u_j'} = \mu_t\left(\frac{\partial \overline{u_i}}{\partial x_j} + \frac{\partial \overline{u_j}}{\partial x_i}\right)$$
    
- **Standard k-$\epsilon$ Model:** A two-equation model solving for:
    
    1. **$k$:** Turbulent Kinetic Energy (production and transport).
        
    2. **$\epsilon$:** Dissipation rate of $k$.
        
- **Other RANS models:** Shear Stress Transport (SST), $k-\omega$, and the more complex Reynolds Stress Model (RSM).
    

### Large Eddy Simulation (LES)

Unlike RANS, LES resolves the large, energy-containing scales in time and space, while only modeling the smallest "subgrid" scales.

- **Smagorinsky Model:** Uses a subgrid-scale (SGS) eddy viscosity $\mu_t = C_s^2 \rho \Delta^2 |\bar{S}|$.
    
- **Advanced SGS Models:**
    
    - **Dynamic Smagorinsky:** Calculates $C_s$ locally by filtering the field twice.
        
    - **WALE (Wall-Adapting Local Eddy-viscosity):** Better for complex geometries; naturally goes to zero at walls.
        

## 3. Staggered Grids and Finite Volumes

### Staggered Grids

In high Reynolds number flows, storing all variables (velocity and pressure) at the same grid point (collocated grid) can lead to numerical instabilities and unphysical oscillations (e.g., "checkerboard" pressure).

- **Solution:** Store scalars (pressure, temperature) at cell centers, and velocity components ($u, v, w$) at cell faces.
    
- **Benefit:** This ensures that the pressure gradient and momentum transport are coupled correctly, preventing the scheme from "crashing" due to pure advection.
    

### Finite Volume Method (FVM)

While Finite Differences are efficient for regular grids, **FVM** is superior for complex geometries and ensures **local conservation**.

- **Integral Formulation:** Consider the conservation law $\frac{\partial \mathbf{u}}{\partial t} + \nabla \cdot \mathbf{f}(\mathbf{u}) = 0$.
    
- We integrate over a control volume $V_i$:
    
    $$\int_{V_i} \frac{\partial \mathbf{u}}{\partial t} dV + \int_{V_i} \nabla \cdot \mathbf{f}(\mathbf{u}) dV = 0$$
    
- Divergence Theorem: Converting the volume integral of the divergence into a surface integral:
    
    $$\int_{V_i} \frac{\partial \mathbf{u}}{\partial t} dV + \sum_k \int_{S_k} \mathbf{f}(\mathbf{u}) \cdot \mathbf{n} dS = 0$$
    

This formulation guarantees that the amount of a quantity leaving one cell is exactly the same as the amount entering the neighbor (Conservation property).

---

# üí° Key Takeaways

- **GCS** is essential to prove that your mesh is fine enough to capture the physics accurately.
    
- **Turbulence models** ($k-\epsilon$, LES) provide an "eddy viscosity" to account for energy dissipation that the grid cannot resolve.
    
- **RANS** is the industry standard (averaged), while **LES** is more accurate for transient, large-scale structures.
    
- **Finite Volume Methods** with **Staggered Grids** are the most robust choice for incompressible Navier-Stokes at high $Re$ because they enforce mass and momentum conservation.
    

---

# üí≠ Questions

- Why does the central difference scheme fail at the same grid points for velocity and pressure at high Reynolds numbers?
    
- In the $k-\epsilon$ model, what physically represents the "production" term in the transport equation for $k$?
    
- How does the WALE model improve upon the standard Smagorinsky model near physical boundaries (walls)?
    
- Explain the advantage of using the Divergence Theorem in the FVM formulation compared to a point-wise Finite Difference approach.
    

---

# üê¢ Definitions

- **Kolmogorov Scale ($\eta$):** The length scale where turbulent kinetic energy is converted into heat.
    
- **Closure Problem:** The mathematical difficulty where averaging the NSE creates more unknowns than available equations.
    
- **Eddy Viscosity ($\mu_t$):** A modeled parameter that mimics the mixing and dissipation effects of turbulence.
    
- **Residual:** In GCS, the difference between numerical solutions on different mesh densities.
    
- **No-slip condition:** The requirement that fluid velocity at a solid boundary is zero.
    

---

# üìÖ Homework

- Examine the **Exercise 3** code: implement the GCS and plot the scalar flux $\psi$ against different grid spacings $\Delta y$.
    
- Compare the RANS $k-\epsilon$ parameters ($C_\mu, \sigma_k$, etc.) with the standard literature values provided.
    
- Sketch a 2D staggered grid labeling where $u_{i+1/2, j}$, $v_{i, j+1/2}$, and $P_{i,j}$ are located.